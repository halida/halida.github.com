
---
layout: post
title: 旧_如何在windows下面发布程序
date: 2012-05-01 21:32:54 +0800

comments: true
categories: 
---

因为一个朋友的博客更新， 我重新登录了博客大巴， 偶然发现自己的旧博客，
就补救了几篇博客回来 年岁已久， 重新整理在这里。也算是一份历史资料吧。

--发布时间： 2008-02-15

程序写好了，如何给其他人使用呢？

如果是在linux下面，直接把源程序打包一下，然后写一个readme.txt，里面写上编译需要的模块，以及安装的方法就好了，会用linux的人一定会安装的。

不过在windows下面，就没有那么简单了。还是需要做出一个安装程序来的。

我看过了一些专门做安装程序的软件，太专业了，没有必要把简单的小程序发布搞复杂。我用的方法是，做一个自解压程序。

自解压程序可以使用winrar，里面支持这样的功能，做起来也很简单。但是好像winrar是商业版的程序，还是不用它算了。

我用的程序是7-zip，一个专门用来压缩与解压的程序。

制作自解压程序的方法是:

    7z a -sfx7z.sfx [自解压程序名] [需要压缩的文件]

7-zip还可以用来把一堆文件制作成一个单独的exe文件，方法是用7-zip的制作安装包的功能，选定一个解压后自动运行的程序：

先把文件压缩起来。

再运行 copy /b 7zS.sfx + config.txt + [用7-zip压缩后的文件名]
[可执行文件名]

7zS.sfx可以从
http://prdownloads.sourceforge.net/sevenzip/（7-zip的下载地址）
里面的extra包（比如7z457\_extra.7z）里面得到，这是一个7-zip用来做安装程序的模块，
上面语句的原理是直接把config.txt
和压缩文件附到这个7zS.sfx后面，就成为一个exe文件了。

config.txt是设置文件，我是这样写的:

    ;!@Install@!UTF-8!
    Title="rest"
    RunProgram="\dist\rest.exe"
    ;!@InstallEnd@!

runprogram是解压缩后执行的文件。

这样就生成了一个可执行文件。运行后，经过一个解压的过程后（文件解压在某个不为人知的地方），就自动运行压缩包里面的文件了。运行完毕后会自动删除解压的临时文件。

具体的设置，查看7-zip文档的-sfx部分。