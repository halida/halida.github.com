---
layout: post
title: "家用NAS机器设计方案"
date: 2023-01-09 14:46:27 +0800
comments: true
categories:
---

如何构建一台好用的家用NAS存储服务？

一些错误构建思路：

- 为了节省空间选用了小主机：空间太小难装，散热不好，拓展不行。
- 退役二手服务器：功耗高，噪音大，设备针对场景是高并发弱处理，家用场景是低并发强处理。
- AIO(all in one)：和应用放在一起跑，应用把机器搞挂了，存储也伤了。

家用的特性：

- 人工访问的次数不多，但是每次访问要足够快。
- 给其它家用服务做基础存储，比如图片墙，媒体中心。
- 重要数据保证不丢，大量电影视频存储。
- 和人在一个空间，要静音。

我的解决方案如下：

- 机箱用多硬盘位的塔式机箱就好，静音，方便移动，不用买贵货，100左右的商用多硬盘机箱就可以。不要搞机架，不容易拆，吵。专门的3U，4U服务器机箱也可以，都不贵。硬盘和机箱接触位置要用防共振连接。
- CPU采用最新制程，这样保证功耗比最低，不用特别强调低功耗CPU，因为性价比不高，NAS主要功耗也还是在硬盘上面。用普通入门CPU就好，比如i3 8100。
- 主板最好用ecc架构，不过没有也无所谓，因为比较难买主板。
- 主板普通主板就好，多一些sata口接硬盘，或者加一根PCIE转接卡就行，如果用服务器主板就可以支持IPAM，但是个人经验家用意义不大。
- 电源要算好能够支持所有硬盘，功率不够容易损坏硬盘。
- 接磁盘不需要热拔插，关机开机换磁盘频次不多，大机箱拆装硬盘也不麻烦。
- 硬盘选可以24小时跑的磁盘中便宜的，单个空间大一些，节省功耗和sata位，不要企业级，因为转速高吵，家用也不需要高转速增加读写性能。
- 操作系统用TrueNAS，适合做NAS。
- 数据安全：用TrueNas的软件RAID10，容易替换，容易恢复，RAID5难恢复。另外找一个旧机器同样装NAS，放在其它地方做数据镜像备份，单个机器还是不够安全。
